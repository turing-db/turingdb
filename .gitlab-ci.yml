default:
  image: 799170964164.dkr.ecr.eu-west-2.amazonaws.com/turing:latest

stages:
  - build

build-job:
  tags:
    - docker
  stage: build
  before_script:
  - git remote prune origin  # Remove stale remote branches
  - git fetch --prune --all  # Fetch fresh refs, removing old ones
  - git branch -r            # List remote branches for verification
  script:
    - date
    - source /turing/setup.sh
    - date
    - make -j4
    - date
    - make test
    - date
    - release/check_python.sh
    - date
    - make regress
    - date
    - make run_samples
    - date
  artifacts:
    when: always
    paths:
      - unit_tests.xml
      - test/regress
    reports:
      junit: unit_tests.xml
